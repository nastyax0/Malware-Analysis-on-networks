## INTRODUCTION
Often users while browsing may download some content without verification, a general idea of HTTPs it is secured but often attackers may use it for their advantage.

Site for reference: https://www.malware-traffic-analysis.net/2018/11/29/index.html

Given a pcap: 2018-11-29-Hancitor-infection-with-Ursnif.pcap.zip

password: infected_20181129

### Acknowledgement of pcap file(and resources):
#### Author: BRAD DUNCAN
#### Site: https://www.malware-traffic-analysis.net/

## THEORY
Hancitor, also known as Chanitor, is a malware designed to install other malware on targeted devices. Hancitor has been active since 2013, and was typically delivered as an attachment through spear-phishing emails with varying lure themes. However, from 2020 onwards, threat actors have been using DocuSign-themed lures to entice target users into opening links in emails, which then lead to another link that downloads a document with a malicious macro that contains the main Hancitor payload.

Once on the target device, Hancitor performs initial reconnaissance, connects to the attackers' command-and-control (C2) server, and downloads additional malware, including banking trojans like Zloader and Vawtrak, and information stealers like Pony and Ficker. In some campaigns, attackers have also used Hancitor to install Cobalt Strike or exploit CVE-2020-1472. In all these infections, Hancitor uses these tools to perform various malicious activities, including lateral movement, credential theft, and data exfiltration. (https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Win32/Hancitor#:~:text=Hancitor%2C%20also%20known%20as%20Chanitor%2C%20is%20a%20malware,attachment%20through%20spear-phishing%20emails%20with%20varying%20lure%20themes.)

Urnsif is banking trojan, stealer, and spyware and belongs to older families of malware, 

Here in this example pcap we would see how hancitor is installing urnsif, via document which has malicious macro (payload) in it.

## INVESTIGATION
By turning basic+ filter on, i started checking GET requests,

![Screenshot 2024-07-22 124839](https://github.com/user-attachments/assets/f2022b54-8630-4a19-a100-15ef3674075f),


follow its http stream, (right click, follow, http stream) //I usually put my github writing things under gpt for spell errors and any techincal inaccuracy, it always complain i dont put enough steps :(

![Screenshot 2024-07-22 124942](https://github.com/user-attachments/assets/c38a6fb5-16ea-4080-9660-9eef095f5b0e)

Afterwards,

![Screenshot 2024-07-22 192027](https://github.com/user-attachments/assets/a971eb26-a2d0-4007-b917-2de39e822f74)

We see a doc file here,

Lets analyze it,





















Next up follow http stream for second line,

![Screenshot 2024-07-22 200839](https://github.com/user-attachments/assets/6b08e00b-7fd7-4014-9b12-397a7a95069b)

Nothing much trying to get public address,  but real question is why? See the timeline after 1 hour nearly somehow our client (10.11.29.101) got activated just to 

get public address?

GUID=4520674659239663104&BUILD=29qni11&INFO=FANN-WIN-PC @ FANN-WIN-PC\danny&IP=173.66.46.112&TYPE=1&WIN=6.1(x64)

> 2018-11-29 23:02:03	10.11.29.101	185.112.82.114	HTTP	415	POST /4/forum.php HTTP/1.1  (application/x-www-form-urlencoded)

In next line(3rd), our client even sends the their GUID, build, info, username of pc, IP, system type and architecture as POST request to 185.112.82.114, along

with

![Screenshot 2024-07-22 201323](https://github.com/user-attachments/assets/dcec800c-33ad-4e10-815f-7016b4157c79)

String appears to be base64 lets decode to file, (why file uhm site suggested to convert it to file lol). 

> https://base64.guru/converter/decode/file

![Screenshot 2024-07-22 202113](https://github.com/user-attachments/assets/b774c83f-a05b-41fe-a755-f29963e5333b)

okay along with a binary file? MIME type is application/octet-stream? what is this?

![Screenshot 2024-05-25 235730](https://github.com/user-attachments/assets/1d55ac69-ef46-4a31-89b6-bdf65bffe1c0)

(https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types)
okay?

following next packet stream gives us,

![Screenshot 2024-07-22 204937](https://github.com/user-attachments/assets/4cba6f0d-f594-4ebc-812e-6f6ff909075d)

MIME is text/html but its gibberish (it may be binary too)? client is using GET request to get this file from 81.177.140.147

in our basic + filter later on we can see syn, ack process going on between Src: 10.11.29.101 and Dst: 81.177.140.147 meaning that file is being downloaded by 

client.

After data sent by tcp,

2018-11-29 23:02:07	src:81.177.140.147	dst:10.11.29.101	HTTP	450	HTTP/1.1 200 OK  (text/html)

server replies OK to client okay....

Likewise its GETs from 81.177.140.147 these two more

> 2018-11-29 23:02:14	10.11.29.101	81.177.140.147	HTTP	227	GET /wp-includes/2 HTTP/1.1

> 2018-11-29 23:02:15	10.11.29.101	81.177.140.147	HTTP	227	GET /wp-includes/3 HTTP/1.1 



















